<!doctype html>
<head>
    <title>12 Credits</title>
</head>

<body>
    <canvas id="gameCanvas" height="600" width="1200"></canvas>
    <script>
        var canvas;
        var canvasContext;

        window.onload = function(){
            canvas = document.getElementById('gameCanvas');
            canvasContext = canvas.getContext('2d');

            document.addEventListener('keydown', keyPressed);
            document.addEventListener('keyup', keyReleased);

            setInterval(mainloop, 1000/50);
        }

        /* xpos, xwidth, ypos, yheight */
        /* sml platform = 347 to 469, 384 to 394,  */
        /* med platform = 703 to 854, 348 to 359,  */
        /* lrg platform = 474 to 670, 278 to 288,  */

        const LEFT_KEY = 65;        /* 'A' */
        const RIGHT_KEY = 68;       /* 'D' */
        const JUMP_KEY = 87;          /* 'W' */
        const USE_KEY = 32;         /* 'E' */


        var leftKeyPressed = false;
        var rightKeyPressed = false;
        var jumpKeyPressed = false;
        var useKeyPressed = false;

        var pXpos = 0;
        var pYpos = 575;
        var pXspeed = 5;
        var pYvel = 0;
        var pJump = false;
        const pSIZE = 25;

        var eXpos = 300;
        var eYpos = 300;
        var eXspeed = 3;
        var eYvel = 0;
        const eSIZE = 25;

        var smlXpos = 347;
        var smlYpos = 384;
        var sml_width = 122;
        var sml_height = 10;

        var medXpos = 703;
        var medYpos = 348;
        var med_width = 151;
        var med_height = 11;


        var lrgXpos = 474;
        var lrgYpos = 278;
        var lrg_width = 196;
        var lrg_height = 10;

        var bg = new Image();
        bg.src = 'background.png';

        var userName = ' ';

        while(userName == ' ' || userName == null) {
            userName = prompt('What is your name?');
        }

        var gameRun = true;

        function mainloop(){
            

            if(gameRun){
            drawImg(bg,0,0,1200,600);
            // colorRect(0, 0, canvas.width,canvas.height, 'black');
            // colorRect(smlXpos, smlYpos, sml_width, sml_height, 'blue');
            // colorRect(medXpos, medYpos, med_width, med_height, 'purple');
            // colorRect(lrgXpos, lrgYpos, lrg_width, lrg_height, 'orange');
            colorRect(pXpos,pYpos,pSIZE, pSIZE,'green');
            colorRect(eXpos,eYpos,eSIZE, eSIZE,'red');
            

            playerMove();
            enemyMove();
            }
            else {
                colorRect(0,0,canvas.width, canvas.height, 'red');
            }

        }

        function colorRect(x,y,w,h,c){
            canvasContext.fillStyle = c;
            canvasContext.fillRect(x,y,w,h);
        }
        
        function colorText(msg,x,y,f,c){
            canvasContext.fillStyle = c;
            canvasContext.fillRect(x,y,w,h);
        }

        function drawImg(src,x,y,w,h){
            canvasContext.drawImage(src,x,y,w,h);
        }

        function keyPressed(evt) {
            console.log(evt.keyCode);
            if (evt.keyCode == LEFT_KEY) {
                leftKeyPressed = true;
            }
            if (evt.keyCode == RIGHT_KEY) {
                rightKeyPressed = true;
            }
            if (evt.keyCode == JUMP_KEY) {
                jumpKeyPressed = true;
                jumping = true;
            }
            if (evt.keyCode == USE_KEY) {
                useKeyPressed = true;
            }
        }

        function keyReleased(evt) {
            if (evt.keyCode == LEFT_KEY) {
                leftKeyPressed = false;
            }
            if (evt.keyCode == RIGHT_KEY) {
                rightKeyPressed = false;
            }
            if (evt.keyCode == JUMP_KEY) {
                jumpKeyPressed = false;
            }
            if (evt.keyCode == USE_KEY) {
                useKeyPressed = false;
            }
        }

        function playerMove() {
            if (leftKeyPressed == true) {
                pXpos -= pXspeed;
                if(pXpos < 0){
                    pXpos += pXspeed;
                }
                
                    if(pXpos < smlXpos + sml_width && pYpos < smlYpos + sml_height && pYpos > smlYpos){
                    pXpos += pXspeed;
                    }

                    if(pXpos < medXpos + med_width && pYpos < medYpos + med_height && pYpos > medYpos){
                    pXpos += pXspeed;
                    }

                    if(pXpos < lrgXpos + lrg_width && pYpos < lrgYpos + lrg_height && pYpos > lrgYpos){
                    pXpos += pXspeed;
                    }
            }
            if (rightKeyPressed == true) {
                pXpos += pXspeed;
                if(pXpos > canvas.width - pSIZE){
                    pXpos -= pXspeed;
                }
                if(pXpos > smlXpos && pYpos < smlYpos + sml_height && pYpos > smlYpos || pXpos + pSIZE > smlXpos && pYpos < smlYpos + sml_height && pYpos > smlYpos){
                    pXpos -= pXspeed;
                }

                if(pXpos > medXpos && pYpos < medYpos + med_height && pYpos > medYpos || pXpos + pSIZE > medXpos && pYpos < medYpos + med_height && pYpos > medYpos){
                    pXpos -= pXspeed;
                }

                if(pXpos > lrgXpos && pYpos < lrgYpos + lrg_height && pYpos > lrgYpos || pXpos + pSIZE > lrgXpos && pYpos < lrgYpos + lrg_height && pYpos > lrgYpos){
                    pXpos -= pXspeed;
                }
            }
            if(jumpKeyPressed == true){
                 pYvel = 7;
                 pJump = true;
                if (pYpos < 0){
                    pYvel = -5;
                }
            }
            if(pJump == true) {
                pYpos -= pYvel;
                pYvel -= 0.3;
                
                if(pYpos > canvas.height){
                    pYvel = 0;
                    pYpos = canvas.height - pSIZE;
                    pJump = false;
                }
                if(pYpos > blockYpos && pYpos < blockYpos + block_height && pXpos < blockXpos + block_width && pXpos > blockXpos){
                    pYvel = 0;
                    pYpos = blockYpos - pSIZE;
                    pJump = false;
                }
                if(pYpos < blockYpos + block_height && pYpos > blockYpos && pXpos < blockXpos + block_width && pXpos > blockXpos){
                    pYpos -= pYvel;
                    pJump = false;
                }
            }

        }

        function enemyMove(){
            if(pXpos > eXpos){
                eXpos += eXspeed;
            }
            if(pXpos < eXpos){
                eXpos -= eXspeed;
            }
            // if(pYpos > eYpos){
            //     eYpos += eYspeed;
            // }
            // if(pYpos < eYpos){
            //     eYpos -= eYspeed;
            // }
        }


    </script>
</body>